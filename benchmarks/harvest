#!/usr/bin/perl

use strict;
use warnings;
use lib '.';
my @tools = qw/ultimate aprove/;
use Parsers qw{parse find_benchmarks};

my $bdir = shift @ARGV or die "usage: ./harvest <benchdir> <tmpdir>\n";
my $outdir = shift @ARGV or die "usage: ./harvest <benchdir> <tmpdir>\n";

my ($benchdir,@benches) = Parsers::find_benchmarks($bdir);

################### Harvesting the results
print "% Tool   Benchmark                     Time    Result\n";
print "% ============================================\n";
my %b2res;
foreach my $tool (@tools) {
  foreach my $b (@benches) {
    my $logfn = "$benchdir/$outdir/$tool-$b.log";
    $b2res{$b} = Parsers::parse($tool,$logfn);
    printf "%-10s & %-40s & %8.2f & %-10s\n", $tool, "$bdir/$b", $b2res{$b}->{time}, $b2res{$b}->{result};
  }
}
